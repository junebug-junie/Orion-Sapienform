<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Orion Hub</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="/static/css/style.css?v=1.0.8" />
</head>
<body class="bg-black text-gray-200 flex items-center justify-center min-h-screen p-4 md:p-6" data-toast-seconds="{{NOTIFY_TOAST_SECONDS}}">
  <div
    id="hub-panel-host"
    style="position:fixed; inset:0; padding:80px 24px 24px 24px; overflow:auto; z-index:10; pointer-events:none;"
  ></div>
          <div class="space-y-2 pt-2 border-t border-gray-700">
            <label class="block text-[10px] uppercase tracking-wide text-gray-500">Run ID</label>
            <div class="flex items-center gap-2">
              <input id="tsRunId" class="flex-1 bg-gray-800 text-gray-200 rounded border border-gray-700 px-2 py-1 text-xs" placeholder="run UUID" />
              <button id="tsCopyRunId" class="bg-gray-800 hover:bg-gray-700 text-gray-200 rounded px-2 py-1 border border-gray-700 text-xs">Copy</button>
              <button id="tsCopyRunUrl" class="bg-gray-800 hover:bg-gray-700 text-gray-200 rounded px-2 py-1 border border-gray-700 text-xs">Copy URL</button>
            </div>
            <div class="flex items-center gap-2">
              <button id="tsPollRun" class="flex-1 bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg px-3 py-2 text-xs">Poll Status</button>
              <span id="tsRunLoading" class="text-[10px] text-gray-500 hidden">Loading...</span>
            </div>
            <div class="grid grid-cols-2 gap-2 text-[11px] text-gray-300">
              <div class="flex items-center justify-between bg-gray-900/60 border border-gray-700 rounded px-2 py-1">
                <span>Status</span>
                <span id="tsRunState" class="font-semibold">--</span>
              </div>
              <div class="flex items-center justify-between bg-gray-900/60 border border-gray-700 rounded px-2 py-1">
                <span>Clusters</span>
                <span id="tsRunClusters" class="font-semibold">--</span>
              </div>
              <div class="flex items-center justify-between bg-gray-900/60 border border-gray-700 rounded px-2 py-1">
                <span>Docs</span>
                <span id="tsRunDocs" class="font-semibold">--</span>
              </div>
              <div class="flex items-center justify-between bg-gray-900/60 border border-gray-700 rounded px-2 py-1">
                <span>Segments</span>
                <span id="tsRunSegments" class="font-semibold">--</span>
              </div>
              <div class="flex items-center justify-between bg-gray-900/60 border border-gray-700 rounded px-2 py-1">
                <span>Outlier %</span>
                <span id="tsRunOutliers" class="font-semibold">--</span>
              </div>
              <div class="flex items-center justify-between bg-gray-900/60 border border-gray-700 rounded px-2 py-1">
                <span>Enriched</span>
                <span id="tsRunEnriched" class="font-semibold">--</span>
              </div>
            </div>
            <div class="text-[10px] uppercase tracking-wide text-gray-500">Artifacts</div>
            <pre id="tsRunArtifacts" class="text-[10px] text-gray-200 bg-gray-900/60 border border-gray-700 rounded p-2 whitespace-pre-wrap">--</pre>
            <div class="flex items-center gap-2 text-[10px] text-gray-400">
              <button id="tsCopyArtifacts" class="bg-gray-800 hover:bg-gray-700 text-gray-200 rounded px-2 py-1 border border-gray-700 text-xs">Copy artifacts</button>
            </div>
            <div id="tsRunError" class="text-[11px] text-red-300">--</div>
            <div id="tsRunWarning" class="text-[11px] text-amber-300 hidden"></div>
          </div>

          <div class="space-y-2 pt-2 border-t border-gray-700">
            <div class="text-[10px] uppercase tracking-wide text-gray-500">Recent runs</div>
            <select id="tsRunsSelect" class="w-full bg-gray-800 text-gray-200 rounded border border-gray-700 px-2 py-1 text-xs"></select>
            <div id="tsRunsWarning" class="text-[11px] text-amber-300 hidden"></div>
          </div>

          <div class="space-y-2 pt-2 border-t border-gray-700">
            <div class="flex items-center justify-between">
              <div class="text-[10px] uppercase tracking-wide text-gray-500">Browse segments</div>
              <button id="tsSegmentsRefresh" class="text-[10px] text-gray-300 hover:text-white">Refresh</button>
            </div>
            <input id="tsSegmentsRunId" class="w-full bg-gray-800 text-gray-200 rounded border border-gray-700 px-2 py-1 text-xs" placeholder="run UUID" />
            <div class="grid grid-cols-2 gap-2">
              <input id="tsSegmentsSearch" class="bg-gray-800 text-gray-200 rounded border border-gray-700 px-2 py-1 text-xs" placeholder="search segments" />
              <select id="tsSegmentsSort" class="bg-gray-800 text-gray-200 rounded border border-gray-700 px-2 py-1 text-xs">
                <option value="time_desc">time desc</option>
                <option value="friction_desc">friction desc</option>
                <option value="size_desc">size desc</option>
              </select>
            </div>
            <div class="grid grid-cols-2 gap-2">
              <select id="tsSegmentsEnrichment" class="bg-gray-800 text-gray-200 rounded border border-gray-700 px-2 py-1 text-xs">
                <option value="">all</option>
                <option value="true">has enrichment</option>
                <option value="false">no enrichment</option>
              </select>
              <input id="tsSegmentsAspect" class="bg-gray-800 text-gray-200 rounded border border-gray-700 px-2 py-1 text-xs" placeholder="aspect filter" />
            </div>
            <div id="tsSegmentsFacets" class="flex flex-wrap gap-2 text-[10px] text-gray-400"></div>
            <div class="flex items-center gap-2">
              <button id="tsLoadSegments" class="flex-1 bg-gray-800 hover:bg-gray-700 text-gray-200 rounded-lg px-3 py-2 border border-gray-700 text-xs">Load Segments</button>
              <span id="tsSegmentsLoading" class="text-[10px] text-gray-500 hidden">Loading...</span>
            </div>
            <div class="flex flex-wrap items-center justify-between gap-2 text-[10px] text-gray-400">
              <div class="flex items-center gap-2">
                <label class="uppercase tracking-wide text-gray-500">Page size</label>
                <select id="tsSegmentsPageSize" class="bg-gray-800 text-gray-200 rounded border border-gray-700 px-2 py-1 text-xs">
                  <option value="50">50</option>
                  <option value="100">100</option>
                  <option value="200">200</option>
                </select>
                <button id="tsSegmentsPrev" class="bg-gray-800 hover:bg-gray-700 text-gray-200 rounded px-2 py-1 border border-gray-700 text-xs">Prev</button>
                <button id="tsSegmentsNext" class="bg-gray-800 hover:bg-gray-700 text-gray-200 rounded px-2 py-1 border border-gray-700 text-xs">Next</button>
              </div>
              <div id="tsSegmentsRange" class="text-[10px] text-gray-500">Offset --</div>
              <button id="tsSegmentsExport" class="bg-indigo-600 hover:bg-indigo-500 text-white rounded px-2 py-1 text-xs">Export CSV</button>
            </div>
            <div id="tsSegmentsError" class="text-[11px] text-red-300">--</div>
            <div id="tsSegmentsDebug" class="text-[10px] text-gray-500 hidden"></div>
            <div class="text-[10px] text-gray-400">size = number of dataset rows included in the window.</div>
            <div class="overflow-x-auto">
              <table class="w-full text-xs text-left text-gray-300">
                <thead class="text-[10px] uppercase text-gray-500 border-b border-gray-700">
                  <tr>
                    <th class="py-2 pr-3">Segment</th>
                    <th class="py-2 pr-3">Size</th>
                    <th class="py-2 pr-3">Row IDs</th>
                    <th class="py-2 pr-3">Chars</th>
                    <th class="py-2 pr-3">Title</th>
                    <th class="py-2 pr-3">Aspects</th>
                    <th class="py-2 pr-3">Start</th>
                    <th class="py-2 pr-3">End</th>
                    <th class="py-2 pr-3">Snippet</th>
                    <th class="py-2 pr-3">Topic</th>
                    <th class="py-2 pr-3">Topic prob</th>
                    <th class="py-2 pr-3">Outlier</th>
                    <th class="py-2 pr-3">Friction</th>
                  </tr>
                </thead>
                <tbody id="tsSegmentsTableBody" class="divide-y divide-gray-800"></tbody>
              </table>
            </div>
          </div>
          </div>

        <div id="tsSubviewConversations" class="hidden space-y-4">
            <div class="text-xs uppercase tracking-wide text-gray-500">Conversation Stitching</div>
            <div class="grid grid-cols-2 gap-2">
              <div class="space-y-2">
                <label class="block text-[10px] uppercase tracking-wide text-gray-500">Dataset</label>
                <select id="tsConvoDatasetSelect" class="w-full bg-gray-800 text-gray-200 rounded border border-gray-700 px-2 py-1 text-xs"></select>
              </div>
              <div class="space-y-2">
                <label class="block text-[10px] uppercase tracking-wide text-gray-500">Limit</label>
                <input id="tsConvoLimit" type="number" min="1" class="w-full bg-gray-800 text-gray-200 rounded border border-gray-700 px-2 py-1 text-xs" value="200" />
              </div>
            </div>
            <div class="grid grid-cols-2 gap-2">
              <div class="space-y-2">
                <label class="block text-[10px] uppercase tracking-wide text-gray-500">Start at</label>
                <input id="tsConvoStartAt" type="datetime-local" class="w-full bg-gray-800 text-gray-200 rounded border border-gray-700 px-2 py-1 text-xs" />
              </div>
              <div class="space-y-2">
                <label class="block text-[10px] uppercase tracking-wide text-gray-500">End at</label>
                <input id="tsConvoEndAt" type="datetime-local" class="w-full bg-gray-800 text-gray-200 rounded border border-gray-700 px-2 py-1 text-xs" />
              </div>
            </div>
            <div class="flex items-center gap-2">
              <button id="tsConvoLoad" class="bg-gray-800 hover:bg-gray-700 text-gray-200 rounded-lg px-3 py-2 border border-gray-700 text-xs">Load Conversations</button>
              <button id="tsConvoRebuildPreview" class="bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg px-3 py-2 text-xs">Rebuild Preview</button>
              <span id="tsConvoLoading" class="text-[10px] text-gray-500 hidden">Loading...</span>
            </div>
            <div class="grid grid-cols-2 gap-4">
              <div class="space-y-2">
                <div class="text-[10px] uppercase tracking-wide text-gray-500">Conversations</div>
                <div class="text-[11px] text-gray-300 bg-gray-900/60 border border-gray-700 rounded p-2 max-h-64 overflow-y-auto">
                  <table class="w-full text-xs text-left text-gray-300">
                    <thead class="text-[10px] uppercase text-gray-500 border-b border-gray-700">
                      <tr>
                        <th class="py-2 pr-2">Select</th>
                        <th class="py-2 pr-2">Window</th>
                        <th class="py-2 pr-2">Blocks</th>
                        <th class="py-2 pr-2">Snippet</th>
                        <th class="py-2 pr-2">ID</th>
                      </tr>
                    </thead>
                    <tbody id="tsConvoList" class="divide-y divide-gray-800"></tbody>
                  </table>
                </div>
                <div class="flex items-center gap-2">
                  <input id="tsConvoMergeReason" class="flex-1 bg-gray-800 text-gray-200 rounded border border-gray-700 px-2 py-1 text-xs" placeholder="merge reason (optional)" />
                  <button id="tsConvoMerge" class="bg-indigo-600 hover:bg-indigo-500 text-white rounded px-2 py-1 text-xs">Merge</button>
                </div>
                <div id="tsConvoMergeStatus" class="text-[11px] text-gray-400">--</div>
              </div>
              <div class="space-y-2">
                <div class="text-[10px] uppercase tracking-wide text-gray-500">Conversation Detail</div>
                <div id="tsConvoDetail" class="text-[11px] text-gray-300 bg-gray-900/60 border border-gray-700 rounded p-2 max-h-64 overflow-y-auto">Select a conversation to view blocks.</div>
                <div class="text-[10px] uppercase tracking-wide text-gray-500">Overrides</div>
                <div id="tsConvoOverrides" class="text-[11px] text-gray-300 bg-gray-900/60 border border-gray-700 rounded p-2 max-h-40 overflow-y-auto">--</div>
              </div>
            </div>
            <div id="tsConvoError" class="text-[11px] text-red-300">--</div>
            </div>
          </div>

          <div id="tsSubviewTopics" class="hidden space-y-4">
            <div class="text-xs uppercase tracking-wide text-gray-500">Topic Explorer</div>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-2">
              <input id="tsTopicsRunId" class="bg-gray-800 text-gray-200 rounded border border-gray-700 px-2 py-1 text-xs" placeholder="run UUID" />
              <select id="tsTopicsScope" class="bg-gray-800 text-gray-200 rounded border border-gray-700 px-2 py-1 text-xs">
                <option value="">All scopes</option>
                <option value="macro">Macro topics</option>
                <option value="micro">Micro topics</option>
              </select>
              <div class="grid grid-cols-2 gap-2">
                <input id="tsTopicsLimit" type="number" min="1" class="bg-gray-800 text-gray-200 rounded border border-gray-700 px-2 py-1 text-xs" value="200" />
                <input id="tsTopicsOffset" type="number" min="0" class="bg-gray-800 text-gray-200 rounded border border-gray-700 px-2 py-1 text-xs" value="0" />
              </div>
            </div>
            <div class="flex items-center gap-2">
              <button id="tsTopicsLoad" class="bg-gray-800 hover:bg-gray-700 text-gray-200 rounded-lg px-3 py-2 border border-gray-700 text-xs">Load Topics</button>
              <span id="tsTopicsStatus" class="text-[10px] text-gray-500">--</span>
            </div>
            <div id="tsTopicsError" class="text-[11px] text-red-300">--</div>
            <div class="overflow-x-auto">
              <table class="w-full text-xs text-left text-gray-300">
                <thead class="text-[10px] uppercase text-gray-500 border-b border-gray-700">
                  <tr>
                    <th class="py-2 pr-3">Topic</th>
                    <th class="py-2 pr-3">Scope</th>
                    <th class="py-2 pr-3">Docs</th>
                    <th class="py-2 pr-3">Outlier %</th>
                    <th class="py-2 pr-3">Parent</th>
                    <th class="py-2 pr-3">Action</th>
                  </tr>
                </thead>
                <tbody id="tsTopicsTableBody" class="divide-y divide-gray-800"></tbody>
              </table>
            </div>

            <div class="space-y-2 pt-2 border-t border-gray-700">
              <div class="flex items-center justify-between">
                <div class="text-[10px] uppercase tracking-wide text-gray-500">Selected topic</div>
                <div id="tsTopicSelectedId" class="text-[10px] text-gray-400">--</div>
              </div>
              <div>
                <div class="text-[10px] uppercase tracking-wide text-gray-500">Keywords</div>
                <div id="tsTopicKeywords" class="flex flex-wrap gap-2 text-[10px] text-gray-300">--</div>
              </div>
              <div class="flex flex-wrap items-center justify-between gap-2">
                <div class="text-[10px] uppercase tracking-wide text-gray-500">Segments</div>
                <div class="flex items-center gap-2">
                  <label class="text-[10px] uppercase tracking-wide text-gray-500">Offset</label>
                  <input id="tsTopicSegmentsOffset" type="number" min="0" class="w-20 bg-gray-800 text-gray-200 rounded border border-gray-700 px-2 py-1 text-xs" value="0" />
                  <select id="tsTopicSegmentsLimit" class="bg-gray-800 text-gray-200 rounded border border-gray-700 px-2 py-1 text-xs">
                    <option value="25">25</option>
                    <option value="50" selected>50</option>
                    <option value="100">100</option>
                  </select>
                  <button id="tsTopicSegmentsPrev" class="bg-gray-800 hover:bg-gray-700 text-gray-200 rounded px-2 py-1 border border-gray-700 text-xs">Prev</button>
                  <button id="tsTopicSegmentsNext" class="bg-gray-800 hover:bg-gray-700 text-gray-200 rounded px-2 py-1 border border-gray-700 text-xs">Next</button>
                </div>
              </div>
              <div id="tsTopicSegmentsStatus" class="text-[10px] text-gray-500">--</div>
              <div class="overflow-x-auto">
                <table class="w-full text-xs text-left text-gray-300">
                  <thead class="text-[10px] uppercase text-gray-500 border-b border-gray-700">
                    <tr>
                      <th class="py-2 pr-3">Segment</th>
                      <th class="py-2 pr-3">Size</th>
                      <th class="py-2 pr-3">Title</th>
                      <th class="py-2 pr-3">Bounds</th>
                      <th class="py-2 pr-3">Snippet</th>
                    </tr>
                  </thead>
                  <tbody id="tsTopicSegmentsTableBody" class="divide-y divide-gray-800"></tbody>
                </table>
              </div>
            </div>
          </div>

          <div id="tsSubviewCompare" class="hidden space-y-4">
            <div class="text-xs uppercase tracking-wide text-gray-500">Run Compare</div>
            <div class="grid grid-cols-2 gap-2">
              <select id="tsCompareLeftRunId" class="bg-gray-800 text-gray-200 rounded border border-gray-700 px-2 py-1 text-xs">
                <option value="">Left run…</option>
              </select>
              <select id="tsCompareRightRunId" class="bg-gray-800 text-gray-200 rounded border border-gray-700 px-2 py-1 text-xs">
                <option value="">Right run…</option>
              </select>
            </div>
            <div class="flex items-center gap-2">
              <button id="tsCompareRun" class="bg-gray-800 hover:bg-gray-700 text-gray-200 rounded-lg px-3 py-2 border border-gray-700 text-xs">Compare Runs</button>
              <span id="tsCompareStatus" class="text-[10px] text-gray-500">--</span>
            </div>
            <div id="tsCompareError" class="text-[11px] text-red-300">--</div>
            <div class="grid grid-cols-2 gap-2 text-xs text-gray-300">
              <div class="flex items-center justify-between bg-gray-900/60 border border-gray-700 rounded px-2 py-1">
                <span>Docs</span>
                <span id="tsCompareDocs" class="font-semibold">--</span>
              </div>
              <div class="flex items-center justify-between bg-gray-900/60 border border-gray-700 rounded px-2 py-1">
                <span>Segments</span>
                <span id="tsCompareSegments" class="font-semibold">--</span>
              </div>
              <div class="flex items-center justify-between bg-gray-900/60 border border-gray-700 rounded px-2 py-1">
                <span>Clusters</span>
                <span id="tsCompareClusters" class="font-semibold">--</span>
              </div>
              <div class="flex items-center justify-between bg-gray-900/60 border border-gray-700 rounded px-2 py-1">
                <span>Outlier %</span>
                <span id="tsCompareOutliers" class="font-semibold">--</span>
              </div>
            </div>
            <div class="overflow-x-auto">
              <table class="w-full text-xs text-left text-gray-300">
                <thead class="text-[10px] uppercase text-gray-500 border-b border-gray-700">
                  <tr>
                    <th class="py-2 pr-3">Metric</th>
                    <th class="py-2 pr-3">Left</th>
                    <th class="py-2 pr-3">Right</th>
                    <th class="py-2 pr-3">Delta</th>
                  </tr>
                </thead>
                <tbody id="tsCompareTableBody" class="divide-y divide-gray-800"></tbody>
              </table>
            </div>
            <div class="text-[10px] uppercase tracking-wide text-gray-500">Top aspect deltas</div>
            <div class="overflow-x-auto">
              <table class="w-full text-xs text-left text-gray-300">
                <thead class="text-[10px] uppercase text-gray-500 border-b border-gray-700">
                  <tr>
                    <th class="py-2 pr-3">Aspect</th>
                    <th class="py-2 pr-3">Left</th>
                    <th class="py-2 pr-3">Right</th>
                    <th class="py-2 pr-3">Delta</th>
                  </tr>
                </thead>
                <tbody id="tsCompareAspectBody" class="divide-y divide-gray-800"></tbody>
              </table>
            </div>
          </div>

          <div id="tsSubviewDrift" class="hidden space-y-4">
            <div class="text-xs uppercase tracking-wide text-gray-500">Drift Monitor</div>
            <div class="grid grid-cols-2 gap-2">
              <input id="tsDriftModelName" class="bg-gray-800 text-gray-200 rounded border border-gray-700 px-2 py-1 text-xs" placeholder="model name" />
              <div class="grid grid-cols-2 gap-2">
                <input id="tsDriftWindowHours" type="number" min="1" class="bg-gray-800 text-gray-200 rounded border border-gray-700 px-2 py-1 text-xs" value="24" />
                <input id="tsDriftLimit" type="number" min="1" class="bg-gray-800 text-gray-200 rounded border border-gray-700 px-2 py-1 text-xs" value="50" />
              </div>
            </div>
            <div class="flex items-center gap-2">
              <button id="tsDriftLoad" class="bg-gray-800 hover:bg-gray-700 text-gray-200 rounded-lg px-3 py-2 border border-gray-700 text-xs">Load Drift</button>
              <button id="tsDriftRunNow" class="bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg px-3 py-2 text-xs">Run Drift Now</button>
              <span id="tsDriftStatus" class="text-[10px] text-gray-500">--</span>
            </div>
            <div id="tsDriftError" class="text-[11px] text-red-300">--</div>
            <div class="overflow-x-auto">
              <table class="w-full text-xs text-left text-gray-300">
                <thead class="text-[10px] uppercase text-gray-500 border-b border-gray-700">
                  <tr>
                    <th class="py-2 pr-3">Created</th>
                    <th class="py-2 pr-3">JS</th>
                    <th class="py-2 pr-3">Outlier %</th>
                    <th class="py-2 pr-3">Δ Outlier</th>
                    <th class="py-2 pr-3">Δ Top Topic</th>
                    <th class="py-2 pr-3">Thresholds</th>
                  </tr>
                </thead>
                <tbody id="tsDriftTableBody" class="divide-y divide-gray-800"></tbody>
              </table>
            </div>
          </div>

          <div id="tsSubviewEvents" class="hidden space-y-4">
            <div class="text-xs uppercase tracking-wide text-gray-500">Events</div>
            <div class="grid grid-cols-2 gap-2">
              <select id="tsEventsKind" class="bg-gray-800 text-gray-200 rounded border border-gray-700 px-2 py-1 text-xs">
                <option value="">All kinds</option>
                <option value="run_complete">Run complete</option>
                <option value="enrich_complete">Enrich complete</option>
                <option value="drift_alert">Drift alert</option>
              </select>
              <div class="grid grid-cols-2 gap-2">
                <input id="tsEventsLimit" type="number" min="1" class="bg-gray-800 text-gray-200 rounded border border-gray-700 px-2 py-1 text-xs" value="50" />
                <input id="tsEventsOffset" type="number" min="0" class="bg-gray-800 text-gray-200 rounded border border-gray-700 px-2 py-1 text-xs" value="0" />
              </div>
            </div>
            <div class="flex items-center gap-2">
              <button id="tsEventsLoad" class="bg-gray-800 hover:bg-gray-700 text-gray-200 rounded-lg px-3 py-2 border border-gray-700 text-xs">Load Events</button>
              <button id="tsEventsExport" class="bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg px-3 py-2 text-xs">Export CSV</button>
              <span id="tsEventsStatus" class="text-[10px] text-gray-500">--</span>
            </div>
            <div id="tsEventsError" class="text-[11px] text-red-300">--</div>
            <div class="overflow-x-auto">
              <table class="w-full text-xs text-left text-gray-300">
                <thead class="text-[10px] uppercase text-gray-500 border-b border-gray-700">
                  <tr>
                    <th class="py-2 pr-3">Created</th>
                    <th class="py-2 pr-3">Kind</th>
                    <th class="py-2 pr-3">Run</th>
                    <th class="py-2 pr-3">Model</th>
                    <th class="py-2 pr-3">Bus</th>
                  </tr>
                </thead>
                <tbody id="tsEventsTableBody" class="divide-y divide-gray-800"></tbody>
              </table>
            </div>
          </div>

          <div id="tsSubviewKg" class="hidden space-y-4">
            <div class="text-xs uppercase tracking-wide text-gray-500">Knowledge Graph</div>
            <div class="grid grid-cols-2 gap-2">
              <input id="tsKgRunId" class="bg-gray-800 text-gray-200 rounded border border-gray-700 px-2 py-1 text-xs" placeholder="run UUID" />
              <div class="grid grid-cols-2 gap-2">
                <input id="tsKgLimit" type="number" min="1" class="bg-gray-800 text-gray-200 rounded border border-gray-700 px-2 py-1 text-xs" value="100" />
                <input id="tsKgOffset" type="number" min="0" class="bg-gray-800 text-gray-200 rounded border border-gray-700 px-2 py-1 text-xs" value="0" />
              </div>
            </div>
            <div class="grid grid-cols-2 gap-2">
              <input id="tsKgQuery" class="bg-gray-800 text-gray-200 rounded border border-gray-700 px-2 py-1 text-xs" placeholder="search subject/object" />
              <input id="tsKgPredicate" class="bg-gray-800 text-gray-200 rounded border border-gray-700 px-2 py-1 text-xs" placeholder="predicate filter" />
            </div>
            <div class="flex items-center gap-2">
              <button id="tsKgLoad" class="bg-gray-800 hover:bg-gray-700 text-gray-200 rounded-lg px-3 py-2 border border-gray-700 text-xs">Load Edges</button>
              <button id="tsKgExport" class="bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg px-3 py-2 text-xs">Export CSV</button>
              <span id="tsKgStatus" class="text-[10px] text-gray-500">--</span>
            </div>
            <div id="tsKgError" class="text-[11px] text-red-300">--</div>
            <div class="overflow-x-auto">
              <table class="w-full text-xs text-left text-gray-300">
                <thead class="text-[10px] uppercase text-gray-500 border-b border-gray-700">
                  <tr>
                    <th class="py-2 pr-3">Subject</th>
                    <th class="py-2 pr-3">Predicate</th>
                    <th class="py-2 pr-3">Object</th>
                    <th class="py-2 pr-3">Confidence</th>
                    <th class="py-2 pr-3">Segment</th>
                  </tr>
                </thead>
                <tbody id="tsKgTableBody" class="divide-y divide-gray-800"></tbody>
              </table>
            </div>
          </div>
          </div>
        </div>

        <div class="w-full lg:w-[360px] bg-gray-900/60 border border-gray-700 rounded-xl p-4 flex flex-col min-h-0 overflow-y-auto lg:sticky lg:top-20">
          <div id="tsSegmentDetailsPanel" class="flex flex-col gap-3 min-h-0">
            <div class="flex items-center justify-between">
              <div class="text-xs uppercase tracking-wide text-gray-500">Segment Details</div>
              <button id="tsCopySegmentId" class="bg-gray-800 hover:bg-gray-700 text-gray-200 rounded px-2 py-1 border border-gray-700 text-xs">Copy segment id</button>
            </div>
            <div id="tsSegmentDetailHeader" class="text-sm font-semibold text-gray-200">Select a segment</div>
            <div id="tsSegmentDetailMeta" class="text-[11px] text-gray-400">--</div>
            <div class="space-y-2 pt-2 border-t border-gray-700">
              <div class="text-[10px] uppercase tracking-wide text-gray-500">Snippet</div>
              <pre id="tsSegmentDetailSnippet" class="text-[11px] text-gray-200 bg-gray-900/60 border border-gray-700 rounded p-2 whitespace-pre-wrap">--</pre>
            </div>
            <div class="space-y-2 pt-2 border-t border-gray-700 flex-1 min-h-0">
              <div class="flex items-center justify-between">
                <div class="text-[10px] uppercase tracking-wide text-gray-500">Full text</div>
                <div class="flex items-center gap-2 text-[10px] text-gray-400">
                  <button id="tsSegmentFullTextLoad" class="bg-gray-800 hover:bg-gray-700 text-gray-200 rounded px-2 py-1 border border-gray-700 text-xs">Reload</button>
                  <button id="tsSegmentFullTextExpand" class="bg-gray-800 hover:bg-gray-700 text-gray-200 rounded px-2 py-1 border border-gray-700 text-xs">Expand</button>
                  <button id="tsSegmentFullTextCopy" class="bg-gray-800 hover:bg-gray-700 text-gray-200 rounded px-2 py-1 border border-gray-700 text-xs">Copy</button>
                </div>
              </div>
              <div id="tsSegmentFullTextStatus" class="text-[10px] text-gray-500">--</div>
              <pre id="tsSegmentFullText" class="text-[11px] text-gray-200 bg-gray-950/60 border border-gray-700 rounded p-2 whitespace-pre-wrap overflow-y-auto flex-1 min-h-0">--</pre>
            </div>
            <div class="space-y-2 pt-2 border-t border-gray-700">
              <div class="text-[10px] uppercase tracking-wide text-gray-500">Meaning & enrichment</div>
              <pre id="tsSegmentDetailMeaning" class="text-[11px] text-gray-200 bg-gray-900/60 border border-gray-700 rounded p-2 whitespace-pre-wrap">--</pre>
            </div>
          </div>
        </div>
      </div>
        </div>
      </section>
    </div>

  <div id="toastContainer" class="fixed bottom-6 right-6 z-50 hidden">
    <div class="bg-red-700/90 text-white text-xs px-4 py-2 rounded-lg shadow-lg border border-red-500">
      <span id="toastMessage">Something went wrong.</span>
    </div>
  </div>

  <div id="settingsPanel" class="fixed inset-y-0 right-0 w-full sm:w-[420px] bg-gray-950 border-l border-gray-800 transform translate-x-full transition-transform duration-300 z-30 flex flex-col">
    <div class="flex items-center justify-between px-4 py-3 border-b border-gray-800">
      <div class="text-sm font-semibold text-gray-100">Notification Settings</div>
      <button id="settingsClose" class="text-xs text-gray-400 hover:text-white">Close</button>
    </div>
    <div class="p-4 space-y-6 overflow-y-auto">
      <div class="space-y-3">
        <div class="text-xs uppercase tracking-wide text-gray-500">Recipient Profile</div>
        <div class="grid grid-cols-1 gap-3 text-xs">
          <div>
            <label class="block text-[10px] uppercase tracking-wide text-gray-500 mb-1">Display name</label>
            <input id="notifyDisplayName" type="text" class="w-full bg-gray-800 text-gray-100 rounded border border-gray-700 px-2 py-1" />
          </div>
          <div>
            <label class="block text-[10px] uppercase tracking-wide text-gray-500 mb-1">Timezone</label>
            <input id="notifyTimezone" type="text" class="w-full bg-gray-800 text-gray-100 rounded border border-gray-700 px-2 py-1" placeholder="America/Denver" />
          </div>
          <div class="flex items-center gap-2">
            <input id="notifyQuietEnabled" type="checkbox" class="h-3 w-3 text-indigo-600 rounded bg-gray-700 border-gray-600" />
            <label for="notifyQuietEnabled" class="text-gray-300">Enable quiet hours</label>
          </div>
          <div class="grid grid-cols-2 gap-2">
            <div>
              <label class="block text-[10px] uppercase tracking-wide text-gray-500 mb-1">Quiet start</label>
              <input id="notifyQuietStart" type="time" class="w-full bg-gray-800 text-gray-100 rounded border border-gray-700 px-2 py-1" />
            </div>
            <div>
              <label class="block text-[10px] uppercase tracking-wide text-gray-500 mb-1">Quiet end</label>
              <input id="notifyQuietEnd" type="time" class="w-full bg-gray-800 text-gray-100 rounded border border-gray-700 px-2 py-1" />
            </div>
          </div>
        </div>
      </div>

      <div class="space-y-3">
        <div class="text-xs uppercase tracking-wide text-gray-500">Preferences</div>
        <div class="space-y-3 text-xs">
          <div class="pref-row bg-gray-900/60 border border-gray-800 rounded-lg p-3 space-y-2" data-scope-type="event_kind" data-scope-value="orion.chat.attention">
            <div class="text-xs text-gray-200 font-semibold">Chat Attention</div>
            <div class="flex items-center gap-3 text-[11px]">
              <label class="flex items-center gap-1"><input type="checkbox" class="pref-channel" data-channel="in_app"> In-app</label>
              <label class="flex items-center gap-1"><input type="checkbox" class="pref-channel" data-channel="email"> Email</label>
              <label class="flex items-center gap-1"><input type="checkbox" class="pref-escalation"> Escalate</label>
              <input type="number" class="pref-delay w-16 bg-gray-800 text-gray-100 rounded border border-gray-700 px-2 py-1" placeholder="min" min="1" />
            </div>
          </div>

          <div class="pref-row bg-gray-900/60 border border-gray-800 rounded-lg p-3 space-y-2" data-scope-type="event_kind" data-scope-value="orion.chat.message">
            <div class="text-xs text-gray-200 font-semibold">Chat Message</div>
            <div class="flex items-center gap-3 text-[11px]">
              <label class="flex items-center gap-1"><input type="checkbox" class="pref-channel" data-channel="in_app"> In-app</label>
              <label class="flex items-center gap-1"><input type="checkbox" class="pref-channel" data-channel="email"> Email</label>
              <label class="flex items-center gap-1"><input type="checkbox" class="pref-escalation"> Escalate</label>
              <input type="number" class="pref-delay w-16 bg-gray-800 text-gray-100 rounded border border-gray-700 px-2 py-1" placeholder="min" min="1" />
            </div>
          </div>

          <div class="pref-row bg-gray-900/60 border border-gray-800 rounded-lg p-3 space-y-2" data-scope-type="severity" data-scope-value="error">
            <div class="text-xs text-gray-200 font-semibold">Errors (severity)</div>
            <div class="flex items-center gap-3 text-[11px]">
              <label class="flex items-center gap-1"><input type="checkbox" class="pref-channel" data-channel="in_app"> In-app</label>
              <label class="flex items-center gap-1"><input type="checkbox" class="pref-channel" data-channel="email"> Email</label>
            </div>
          </div>

          <div class="pref-row bg-gray-900/60 border border-gray-800 rounded-lg p-3 space-y-2" data-scope-type="severity" data-scope-value="warning">
            <div class="text-xs text-gray-200 font-semibold">Warnings (severity)</div>
            <div class="flex items-center gap-3 text-[11px]">
              <label class="flex items-center gap-1"><input type="checkbox" class="pref-channel" data-channel="in_app"> In-app</label>
              <label class="flex items-center gap-1"><input type="checkbox" class="pref-channel" data-channel="email"> Email</label>
            </div>
          </div>

          <div class="pref-row bg-gray-900/60 border border-gray-800 rounded-lg p-3 space-y-2" data-scope-type="severity" data-scope-value="info">
            <div class="text-xs text-gray-200 font-semibold">Info (severity)</div>
            <div class="flex items-center gap-3 text-[11px]">
              <label class="flex items-center gap-1"><input type="checkbox" class="pref-channel" data-channel="in_app"> In-app</label>
              <label class="flex items-center gap-1"><input type="checkbox" class="pref-channel" data-channel="email"> Email</label>
            </div>
          </div>
        </div>
      </div>

      <div class="flex items-center justify-between">
        <span id="notifySettingsStatus" class="text-xs text-gray-500">Unsaved changes</span>
        <button id="notifySettingsSave" class="text-xs bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg px-3 py-1">Save</button>
      </div>
    </div>
  </div>
  
  <script>
    window.__HUB_CFG__ = {{HUB_CFG}};
  </script>
  <script src="/static/js/app.js?v=1.0.62" defer></script>
</body>
</html>
