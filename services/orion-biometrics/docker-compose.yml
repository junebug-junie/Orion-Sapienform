services:
  biometrics:
    build:
      context: ../..
      dockerfile: services/orion-biometrics/Dockerfile
    image: orion-biometrics:latest
    container_name: orion-biometrics
    restart: unless-stopped
    privileged: true  # Required for raw hardware access (sensors, gpu)
    environment:
      - SERVICE_NAME=orion-biometrics
      - SERVICE_VERSION=0.1.0
      - ORION_BUS_URL=${ORION_BUS_URL:-redis://orion-redis:6379/0}
      - ORION_BUS_ENABLED=${ORION_BUS_ENABLED:-true}
      - TELEMETRY_PUBLISH_CHANNEL=${TELEMETRY_PUBLISH_CHANNEL:-orion:biometrics:telemetry}
      - TELEMETRY_INTERVAL=10
      - LOG_LEVEL=INFO
      - TABLE_NAME=biometrics_raw
      - NODE_NAME=${NODE_NAME:-unknown}
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              capabilities: [gpu]
