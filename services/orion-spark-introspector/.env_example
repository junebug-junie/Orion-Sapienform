# =======================
# orion-spark-introspector
# =======================

# --- Orion Bus / Redis ---
#ORION_BUS_URL=redis://orion-redis:6379/0
ORION_BUS_ENFORCE_CATALOG=true
ORION_BUS_ENABLED=true

# Identity
SERVICE_NAME=spark-introspector
SERVICE_VERSION=0.2.0
#NODE_NAME=athena

# Platform
HEARTBEAT_INTERVAL_SEC=10
PORT=8444

# --- Inputs ---
# Publishes candidate turns here 
CHANNEL_SPARK_INTROSPECT_CANDIDATE=orion:spark:introspect:candidate*

# Cognition traces published by cortex-exec
CHANNEL_COGNITION_TRACE_PUB=orion:cognition:trace

# --- Outputs ---
# Durable telemetry output (sql-writer ingests this)
CHANNEL_SPARK_TELEMETRY=orion:spark:telemetry

# Spark signals (normalized distress/equilibrium)
CHANNEL_SPARK_SIGNAL=orion:spark:signal
CHANNEL_CORE_EVENTS=orion:core:events

# Turn-effect alerts (opt-in)
TURN_EFFECT_ALERTS_ENABLE=false
TURN_EFFECT_ALERTS_COHERENCE_DROP=0.25
TURN_EFFECT_ALERTS_VALENCE_DROP=0.25
TURN_EFFECT_ALERTS_NOVELTY_SPIKE=0.35
TURN_EFFECT_ALERTS_COOLDOWN_SEC=120
TURN_EFFECT_ALERTS_NOTIFY_ENABLE=false
TURN_EFFECT_ALERTS_DEDUPE_ENABLE=true
TURN_EFFECT_ALERTS_DEDUPE_WINDOW_SEC=600
TURN_EFFECT_ALERTS_DEDUPE_EPS=0.02

# Semantic vector upserts
CHANNEL_VECTOR_SEMANTIC_UPSERT=orion:vector:semantic:upsert

# --- Semantic valence via embeddings ---
CHANNEL_EMBEDDING_GENERATE=orion:embedding:generate
EMBEDDING_RESULT_PREFIX=orion:embedding:result:

VALENCE_ANCHOR_POS_TEXT=I feel hopeful and grateful.
VALENCE_ANCHOR_NEG_TEXT=I feel hopeless and afraid.
VALENCE_GAIN=1.75
VALENCE_ANCHOR_REFRESH_SEC=21600
VALENCE_ANCHOR_TIMEOUT_SEC=10

# Real-time snapshot stream (state-service + UI can subscribe)
CHANNEL_SPARK_STATE_SNAPSHOT=orion:spark:state:snapshot

# Freshness window for state snapshots
SPARK_STATE_VALID_FOR_MS=15000

# Tissue
ORION_TISSUE_SNAPSHOT_PATH=/mnt/storage-lukewarm/orion/spark/tissue-brain.npy

# --- Cortex orchestrator ---
# Bus RPC channel for the orchestrator
CORTEX_REQUEST_CHANNEL=orion:cortex:request

# How long to wait for orchestrator reply
CORTEX_TIMEOUT_SEC=300
