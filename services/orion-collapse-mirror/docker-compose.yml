services:
  orion-collapse-mirror:
    build:
      context: ../..
      dockerfile: services/orion-collapse-mirror/Dockerfile
    image: orion-collapse-mirror:latest
    restart: unless-stopped
    networks:
      - app-net
    environment:
      - POSTGRES_URI=sqlite:////mnt/storage/collapse-mirrors/collapse.db
      - REDIS_URL=redis://orion-redis:6379/0
    volumes:
      - /mnt/storage/collapse-mirrors:/mnt/storage/collapse-mirrors
    ports:
      - "8087:8087"

volumes:
  collapse_data:

networks:
  app-net:
    external: true
